
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Interface to the DIRAC grid &#8212; protopipe 0.5.1.dev21+g51ed745 documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../_static/landing_page.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Development" href="../contribute/index.html" />
    <link rel="prev" title="RegressorDiagnostic" href="../api/protopipe.benchmarks.RegressorDiagnostic.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../index.html">
<p class="title">protopipe</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../install/index.html">
  Getting started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../usage/index.html">
  User Guide
 </a>
</li>

<li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../contribute/index.html">
  Development
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../AUTHORS.html">
  Authors
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../CHANGELOG.html">
  Changelog
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="http://cccta-dataserver.in2p3.fr/data/protopipe/results/html/">Performance<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <div class="dropdown" id="version_switcher">
    <button type="button" class="btn btn-primary btn-sm navbar-btn dropdown-toggle" id="version_switcher_button" data-toggle="dropdown">
        latest  <!-- this text may get changed later by javascript -->
        <span class="caret"></span>
    </button>
    <div id="version_switcher_menu" class="dropdown-menu list-group-flush py-0" aria-labelledby="version_switcher_button">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
</div>

<!-- NOTE: this JS must live here (not in our global JS file) because it relies
     on being processed by Jinja before it is run (specifically for replacing
     variables reference/dirac and {'json_url': '/_static/switcher.json', 'version_match': 'latest'}.
-->

<script type="text/javascript">
// Check if corresponding page path exists in other version of docs
// and, if so, go there instead of the homepage of the other docs version
function checkPageExistsAndRedirect(event) {
    const currentFilePath = "reference/dirac.html",
          tryUrl = event.target.getAttribute("href");
    let otherDocsHomepage = tryUrl.replace(currentFilePath, "");
    $.ajax({
        type: 'HEAD',
        url: tryUrl,
        // if the page exists, go there
        success: function() {
            location.href = tryUrl;
        }
    }).fail(function() {
        location.href = otherDocsHomepage;
    });
    // this prevents the browser from following the href of the clicked node
    // (which is fine because this function takes care of redirecting)
    return false;
}

// Populate the version switcher from the JSON config file
(function () {
    $.getJSON("/_static/switcher.json", function(data, textStatus, jqXHR) {
        const currentFilePath = "reference/dirac.html";
        // create links to the corresponding page in the other docs versions
        $.each(data, function(index, entry) {
            // if no custom name specified (e.g., "latest"), use version string
            if (!("name" in entry)) {
                entry.name = entry.version;
            }
            // create the node
            const node = document.createElement("a");
            node.setAttribute("class", "list-group-item list-group-item-action py-1");
            node.textContent = `${entry.name}`;
            node.setAttribute("href", `${entry.url}${currentFilePath}`);
            // on click, AJAX calls will check if the linked page exists before
            // trying to redirect, and if not, will redirect to the homepage
            // for that version of the docs.
            node.onclick = checkPageExistsAndRedirect;
            // Add dataset values for the version and name in case people want
            // to apply CSS styling based on this information.
            node.dataset["versionName"] = entry.name;
            node.dataset["version"] = entry.version;

            $("#version_switcher_menu").append(node);
            // replace dropdown button text with the preferred display name of
            // this version, rather than using sphinx's 0.5.1.dev21+g51ed745 variable.
            // also highlight the dropdown entry for the currently-viewed
            // version's entry
            if (entry.version == "latest") {
                node.classList.add("active");
                let btn = document.getElementById("version_switcher_button");
                btn.innerText = btn.dataset["activeVersionName"] = entry.name;
                btn.dataset["activeVersion"] = entry.version;
            }
        });
    });
})();
</script>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Quick Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/cta-observatory/protopipe" rel="noopener" target="_blank" title="GitHub"><span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://pypi.org/project/protopipe/" rel="noopener" target="_blank" title="PyPI"><span><i class="fab fa-python"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs..." aria-label="Search the docs..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="scripts.html">
   Scripts (
   <code class="docutils literal notranslate">
    <span class="pre">
     protopipe.scripts
    </span>
   </code>
   )
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="data_training.html">
     Data training
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="model_building.html">
     Building the models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="DL2.html">
     Production of DL2 data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="optimization_cuts_IRFs.html">
     Optimized cuts and IRFs
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="benchmark_script.html">
     Benchmarking
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="pipeline.html">
   Event reconstruction (
   <code class="docutils literal notranslate">
    <span class="pre">
     protopipe.pipeline
    </span>
   </code>
   )
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.camera_radius.html">
     camera_radius
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.effective_focal_lengths.html">
     effective_focal_lengths
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.final_array_to_use.html">
     final_array_to_use
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.get_camera_names.html">
     get_camera_names
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.get_cameras_radii.html">
     get_cameras_radii
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.load_config.html">
     load_config
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.load_models.html">
     load_models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.load_obj.html">
     load_obj
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.make_argparser.html">
     make_argparser
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.prod3b_array.html">
     prod3b_array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.prod5N_array.html">
     prod5N_array
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.read_TRAINING_per_tel_type_with_images.html">
     read_TRAINING_per_tel_type_with_images
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.read_protopipe_TRAINING_per_tel_type.html">
     read_protopipe_TRAINING_per_tel_type
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.save_fig.html">
     save_fig
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.save_obj.html">
     save_obj
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.str2bool.html">
     str2bool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.EventPreparer.html">
     EventPreparer
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.ImageCleaner.html">
     ImageCleaner
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.SignalHandler.html">
     SignalHandler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.bcolors.html">
     bcolors
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.List.html">
     List
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.pipeline.Union.html">
     Union
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="mva.html">
   Multivariate analysis (
   <code class="docutils literal notranslate">
    <span class="pre">
     protopipe.mva
    </span>
   </code>
   )
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.get_evt_model_output.html">
     get_evt_model_output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.get_evt_subarray_model_output.html">
     get_evt_subarray_model_output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.initialize_script_arguments.html">
     initialize_script_arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.make_cut_list.html">
     make_cut_list
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.plot_distributions.html">
     plot_distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.plot_hist.html">
     plot_hist
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.plot_profile.html">
     plot_profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.plot_roc_curve.html">
     plot_roc_curve
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.prepare_data.html">
     prepare_data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.save_output.html">
     save_output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.split_train_test.html">
     split_train_test
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.mva.TrainModel.html">
     TrainModel
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="perf.html">
   Performance generation (
   <code class="docutils literal notranslate">
    <span class="pre">
     protopipe.perf
    </span>
   </code>
   )
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.angular_resolution.html">
     angular_resolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.energy_bias_resolution.html">
     energy_bias_resolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.initialize_script_arguments.html">
     initialize_script_arguments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.load_obj.html">
     load_obj
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.percentiles.html">
     percentiles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.plot_hist.html">
     plot_hist
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.read_DL2_pyirf.html">
     read_DL2_pyirf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.save_obj.html">
     save_obj
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.perf.norm.html">
     norm
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="benchmarks.html">
   Benchmarks (
   <code class="docutils literal notranslate">
    <span class="pre">
     protopipe.benchmarks
    </span>
   </code>
   )
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.add_BTEL1010_weigths_to_data.html">
     add_BTEL1010_weigths_to_data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.add_stats.html">
     add_stats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.average_bias_of_charge_resolution.html">
     average_bias_of_charge_resolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.calculate_RMS_around_1.html">
     calculate_RMS_around_1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.compute_bias.html">
     compute_bias
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.compute_psf.html">
     compute_psf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.compute_resolution.html">
     compute_resolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.compute_weight_BTEL1010.html">
     compute_weight_BTEL1010
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.create_lookup_function.html">
     create_lookup_function
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.get_evt_subarray_model_output.html">
     get_evt_subarray_model_output
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.get_fig_size.html">
     get_fig_size
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.get_single_pixels_spectrum.html">
     get_single_pixels_spectrum
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.load_tel_id.html">
     load_tel_id
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_DL1a_reco_true_correlation.html">
     plot_DL1a_reco_true_correlation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_background_rate.html">
     plot_background_rate
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_bias.html">
     plot_bias
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_binned_mean.html">
     plot_binned_mean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_binned_median.html">
     plot_binned_median
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_distributions.html">
     plot_distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_evt_roc_curve_variation.html">
     plot_evt_roc_curve_variation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_hist.html">
     plot_hist
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_profile.html">
     plot_profile
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_psf.html">
     plot_psf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_resolution.html">
     plot_resolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_roc_curve.html">
     plot_roc_curve
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.plot_sensitivity_from_pyirf.html">
     plot_sensitivity_from_pyirf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.prepare_requirements.html">
     prepare_requirements
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.raise_.html">
     raise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.string_to_boolean.html">
     string_to_boolean
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.sum_of_squares.html">
     sum_of_squares
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.BoostedDecisionTreeDiagnostic.html">
     BoostedDecisionTreeDiagnostic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.ClassifierDiagnostic.html">
     ClassifierDiagnostic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.ModelDiagnostic.html">
     ModelDiagnostic
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.OnlineBinnedStats.html">
     OnlineBinnedStats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/protopipe.benchmarks.RegressorDiagnostic.html">
     RegressorDiagnostic
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Interface to the DIRAC grid
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage mt-5 pt-1 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-a-new-analysis">
   Create a new analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#split-datasets">
   Split datasets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#submit-a-set-of-jobs">
   Submit a set of jobs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#download-data-and-merge-it">
   Download data and merge it
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#upload-models">
   Upload models
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                

<div class="tocsection editthispage">
    <a href="https://github.com/https://github.com/cta-observatory/https://github.com/cta-observatory/protopipe/edit/master/docs/reference/dirac.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="interface-to-the-dirac-grid">
<span id="dirac"></span><h1>Interface to the DIRAC grid<a class="headerlink" href="#interface-to-the-dirac-grid" title="Permalink to this headline">#</a></h1>
<p>This part of the documentation covers the set of commands provided by the
<a class="reference external" href="https://github.com/HealthyPear/protopipe-grid-interface">protopipe-grid-interface</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This package is currently stand-alone.
It is planned to merge it into <em>protopipe</em> as a new module <cite>protopipe.dirac</cite>.</p>
</div>
<p>The most important commands provided by this interface are listed here,</p>
<ul class="simple">
<li><p><a class="reference internal" href="#new"><span class="std std-ref">Create a new analysis</span></a></p></li>
<li><p><a class="reference internal" href="#split"><span class="std std-ref">Split datasets</span></a></p></li>
<li><p><a class="reference internal" href="#submit"><span class="std std-ref">Submit a set of jobs</span></a></p></li>
<li><p><a class="reference internal" href="#download-and-merge"><span class="std std-ref">Download data and merge it</span></a></p></li>
<li><p><a class="reference internal" href="#upload-models"><span class="std std-ref">Upload models</span></a></p></li>
</ul>
<p>There are secondary scripts there are mainly used for debugging.
Please refer to their help (<cite>command_name -h</cite>) in case you need to use them.</p>
<section id="create-a-new-analysis">
<span id="new"></span><h2>Create a new analysis<a class="headerlink" href="#create-a-new-analysis" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">protopipe-CREATE_ANALYSIS</span></code> assumes you work from a common parent directory named <cite>shared_folder</cite> (required) which will host both
the <cite>analyses</cite> directory and a <cite>productions</cite> directory.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the parent directory could change, it was named like this due to the fact
that previous versions of the interface required a containerized solution and the naming
was clearer in that context.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>usage: protopipe-CREATE_ANALYSIS [-h] --analysis_name ANALYSIS_NAME [--analysis_directory_tree ANALYSIS_DIRECTORY_TREE] [--log_file LOG_FILE] [--output_path OUTPUT_PATH] [--GRID-is-DIRAC]
                                [--GRID-home GRID_HOME] [--GRID-path-from-home GRID_PATH_FROM_HOME] [--overwrite-analysis]

Create a directory structure for a CTA data analysis using the protopipe prototype pipeline.

    WARNING: check that the version of protopipe is the one you intend to use!



optional arguments:
-h, --help            show this help message and exit
--analysis_name ANALYSIS_NAME
                        Name of the analysis
--analysis_directory_tree ANALYSIS_DIRECTORY_TREE
                        Analysis workflow YAML file (default: see protopipe_grid_interface.aux)
--log_file LOG_FILE   Override log file path
                                        (default: analysis.log in analysis folder)
--output_path OUTPUT_PATH
                        Full path where the &#39;shared_folder&#39; should be created (or where it already exists)
--GRID-is-DIRAC       The grid on which to run the analysis is the DIRAC grid.
--GRID-home GRID_HOME
                        Path of the user&#39;s home on grid (if DIRAC, /vo.cta.in2p3.fr/user/x/xxx).
--GRID-path-from-home GRID_PATH_FROM_HOME
                        Path of the analysis on the DIRAC grid. Defaults for empty string (user home)
--overwrite-analysis  Overwrite analysis folder (WARNING: you could loose data!)
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><code class="docutils literal notranslate"><span class="pre">protopipe-CREATE_ANALYSIS</span></code> creates an <code class="docutils literal notranslate"><span class="pre">analysis_metadata.yaml</span></code> file with the provided input information.
Many commands benefit from using this file to retrieve such information at runtime so you don’t have to
input it again.
It can be also useful to retrieve data and configuration files from the DIRAC file catalog if you want to
work on someone’s analysis.</p>
<p>It will also create an <code class="docutils literal notranslate"><span class="pre">analysis.log</span></code> file which will be filled anytime you use the main commands,
unless another location is specified.</p>
</div>
</section>
<section id="split-datasets">
<span id="split"></span><h2>Split datasets<a class="headerlink" href="#split-datasets" title="Permalink to this headline">#</a></h2>
<p>After you created a new analysis, head over to the list of available simulation datasets
(either from the CTA wiki or using CTADIRAC tools) and retrieve the original lists of
simtel files per particle type.</p>
<p>With <code class="docutils literal notranslate"><span class="pre">protopipe-SPLIT_DATASET</span></code> you can split these lists in sub-datasets to be stored under the
<cite>data/simtel</cite> folder within your analysis.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">protopipe</span><span class="o">-</span><span class="n">SPLIT_DATASET</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">metadata</span> <span class="n">METADATA</span> <span class="o">|</span> <span class="o">--</span><span class="n">output_path</span> <span class="n">OUTPUT_PATH</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">input_gammas</span> <span class="n">INPUT_GAMMAS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">input_protons</span> <span class="n">INPUT_PROTONS</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">input_electrons</span> <span class="n">INPUT_ELECTRONS</span><span class="p">]</span>
                            <span class="p">[</span><span class="o">--</span><span class="n">split_gammas</span> <span class="n">SPLIT_GAMMAS</span> <span class="p">[</span><span class="n">SPLIT_GAMMAS</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">split_protons</span> <span class="n">SPLIT_PROTONS</span> <span class="p">[</span><span class="n">SPLIT_PROTONS</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">split_electrons</span> <span class="n">SPLIT_ELECTRONS</span> <span class="p">[</span><span class="n">SPLIT_ELECTRONS</span> <span class="o">...</span><span class="p">]]</span>
                            <span class="p">[</span><span class="o">--</span><span class="n">log_file</span> <span class="n">LOG_FILE</span><span class="p">]</span>

<span class="n">Split</span> <span class="n">a</span> <span class="n">simulation</span> <span class="n">dataset</span><span class="o">.</span>

    <span class="n">Requirement</span><span class="p">:</span>
    <span class="o">-</span> <span class="nb">list</span> <span class="n">files</span> <span class="n">should</span> <span class="n">have</span> <span class="o">*.</span><span class="n">list</span> <span class="n">extension</span><span class="o">.</span>

    <span class="n">Default</span> <span class="n">analysis</span> <span class="n">workflow</span> <span class="p">(</span><span class="n">see</span> <span class="n">protopipe</span><span class="o">/</span><span class="n">aux</span><span class="o">/</span><span class="n">standard_analysis_workflow</span><span class="o">.</span><span class="n">yaml</span><span class="p">):</span>
    <span class="o">-</span> <span class="n">a</span> <span class="n">training</span> <span class="n">sample</span> <span class="k">for</span> <span class="n">energy</span> <span class="n">made</span> <span class="n">of</span> <span class="n">gammas</span><span class="p">,</span>
    <span class="o">-</span> <span class="n">a</span> <span class="n">training</span> <span class="n">sample</span> <span class="k">for</span> <span class="n">particle</span> <span class="n">classification</span> <span class="n">made</span> <span class="n">of</span> <span class="n">gammas</span> <span class="ow">and</span> <span class="n">protons</span><span class="p">,</span>
    <span class="o">-</span> <span class="n">a</span> <span class="n">performance</span> <span class="n">sample</span> <span class="n">made</span> <span class="n">of</span> <span class="n">gammas</span><span class="p">,</span> <span class="n">protons</span><span class="p">,</span> <span class="ow">and</span> <span class="n">electrons</span><span class="o">.</span>



<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">--</span><span class="n">metadata</span> <span class="n">METADATA</span>   <span class="n">Analysis</span> <span class="n">metadata</span> <span class="n">file</span> <span class="n">produced</span> <span class="n">at</span> <span class="n">creation</span>
                                <span class="p">(</span><span class="n">recommended</span><span class="p">)</span><span class="o">.</span>
<span class="o">--</span><span class="n">output_path</span> <span class="n">OUTPUT_PATH</span>
                        <span class="n">Specifiy</span> <span class="n">an</span> <span class="n">output</span> <span class="n">directory</span>
<span class="o">--</span><span class="n">input_gammas</span> <span class="n">INPUT_GAMMAS</span>
                        <span class="n">Full</span> <span class="n">path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">gammas</span><span class="o">.</span>
<span class="o">--</span><span class="n">input_protons</span> <span class="n">INPUT_PROTONS</span>
                        <span class="n">Full</span> <span class="n">path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">protons</span><span class="o">.</span>
<span class="o">--</span><span class="n">input_electrons</span> <span class="n">INPUT_ELECTRONS</span>
                        <span class="n">Full</span> <span class="n">path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">original</span> <span class="nb">list</span> <span class="n">of</span> <span class="n">electrons</span><span class="o">.</span>
<span class="o">--</span><span class="n">split_gammas</span> <span class="n">SPLIT_GAMMAS</span> <span class="p">[</span><span class="n">SPLIT_GAMMAS</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">List</span> <span class="n">of</span> <span class="n">percentage</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">split</span> <span class="n">the</span> <span class="n">gammas</span><span class="o">.</span> <span class="n">Default</span> <span class="ow">is</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">80</span><span class="p">]</span>
<span class="o">--</span><span class="n">split_protons</span> <span class="n">SPLIT_PROTONS</span> <span class="p">[</span><span class="n">SPLIT_PROTONS</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">List</span> <span class="n">of</span> <span class="mi">3</span> <span class="n">percentage</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">split</span> <span class="n">the</span> <span class="n">protons</span><span class="o">.</span> <span class="n">Default</span> <span class="ow">is</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">]</span>
<span class="o">--</span><span class="n">split_electrons</span> <span class="n">SPLIT_ELECTRONS</span> <span class="p">[</span><span class="n">SPLIT_ELECTRONS</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">List</span> <span class="n">of</span> <span class="n">percentage</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">to</span> <span class="n">split</span> <span class="n">the</span> <span class="n">electrons</span><span class="o">.</span> <span class="n">Default</span> <span class="ow">is</span> <span class="p">[</span><span class="mi">100</span><span class="p">]</span>
<span class="o">--</span><span class="n">log_file</span> <span class="n">LOG_FILE</span>   <span class="n">Override</span> <span class="n">log</span> <span class="n">file</span> <span class="n">path</span>
                                        <span class="p">(</span><span class="n">ignored</span> <span class="n">when</span> <span class="n">using</span> <span class="n">metadata</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="submit-a-set-of-jobs">
<span id="submit"></span><h2>Submit a set of jobs<a class="headerlink" href="#submit-a-set-of-jobs" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">protopipe-SUBMIT-JOBS</span></code> needs always a valid <cite>grid.yaml</cite> configuration file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Usage</span><span class="p">:</span>
<span class="n">protopipe</span><span class="o">-</span><span class="n">SUBMIT</span><span class="o">-</span><span class="n">JOBS</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="o">...</span>

<span class="n">General</span> <span class="n">options</span><span class="p">:</span>
<span class="o">-</span><span class="n">o</span>  <span class="o">--</span><span class="n">option</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>         <span class="p">:</span> <span class="n">Option</span><span class="o">=</span><span class="n">value</span> <span class="n">to</span> <span class="n">add</span>
<span class="o">-</span><span class="n">s</span>  <span class="o">--</span><span class="n">section</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>        <span class="p">:</span> <span class="n">Set</span> <span class="n">base</span> <span class="n">section</span> <span class="k">for</span> <span class="n">relative</span> <span class="n">parsed</span> <span class="n">options</span>
<span class="o">-</span><span class="n">c</span>  <span class="o">--</span><span class="n">cert</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>           <span class="p">:</span> <span class="n">Use</span> <span class="n">server</span> <span class="n">certificate</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">Core</span> <span class="n">Services</span>
<span class="o">-</span><span class="n">d</span>  <span class="o">--</span><span class="n">debug</span>                  <span class="p">:</span> <span class="n">Set</span> <span class="n">debug</span> <span class="n">mode</span> <span class="p">(</span><span class="o">-</span><span class="n">ddd</span> <span class="ow">is</span> <span class="n">extra</span> <span class="n">debug</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">cfg</span><span class="o">=</span>                   <span class="p">:</span> <span class="n">Load</span> <span class="n">additional</span> <span class="n">config</span> <span class="n">file</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">autoreload</span>             <span class="p">:</span> <span class="n">Automatically</span> <span class="n">restart</span> <span class="k">if</span> <span class="n">there</span><span class="s1">&#39;s any change in the module</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">license</span>                <span class="p">:</span> <span class="n">Show</span> <span class="n">DIRAC</span><span class="s1">&#39;s LICENSE</span>
<span class="o">-</span><span class="n">h</span>  <span class="o">--</span><span class="n">help</span>                   <span class="p">:</span> <span class="n">Shows</span> <span class="n">this</span> <span class="n">help</span>

<span class="n">Options</span><span class="p">:</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">analysis_path</span><span class="o">=</span>         <span class="p">:</span> <span class="n">Full</span> <span class="n">path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">analysis</span> <span class="n">folder</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">output_type</span><span class="o">=</span>           <span class="p">:</span> <span class="n">Output</span> <span class="n">data</span> <span class="nb">type</span> <span class="p">(</span><span class="n">TRAINING</span> <span class="ow">or</span> <span class="n">DL2</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">max_events</span><span class="o">=</span>            <span class="p">:</span> <span class="n">Max</span> <span class="n">number</span> <span class="n">of</span> <span class="n">events</span> <span class="n">to</span> <span class="n">be</span> <span class="n">processed</span> <span class="p">(</span><span class="n">optional</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">upload_analysis_cfg</span><span class="o">=</span>   <span class="p">:</span> <span class="n">If</span> <span class="kc">True</span> <span class="p">(</span><span class="n">default</span><span class="p">),</span> <span class="n">upload</span> <span class="n">analysis</span> <span class="n">configuration</span> <span class="n">file</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">dry</span><span class="o">=</span>                   <span class="p">:</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">do</span> <span class="ow">not</span> <span class="n">submit</span> <span class="n">job</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">test</span><span class="o">=</span>                  <span class="p">:</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">submit</span> <span class="n">only</span> <span class="n">one</span> <span class="n">job</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">save_images</span><span class="o">=</span>           <span class="p">:</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">save</span> <span class="n">images</span> <span class="n">together</span> <span class="k">with</span> <span class="n">parameters</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">debug_script</span><span class="o">=</span>          <span class="p">:</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">save</span> <span class="n">debug</span> <span class="n">information</span> <span class="n">during</span> <span class="n">execution</span> <span class="n">of</span> <span class="n">the</span> <span class="n">script</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">DataReprocessing</span><span class="o">=</span>      <span class="p">:</span> <span class="n">If</span> <span class="kc">True</span> <span class="n">reprocess</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">one</span> <span class="n">site</span> <span class="n">to</span> <span class="n">another</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">False</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">tag</span><span class="o">=</span>                   <span class="p">:</span> <span class="n">Used</span> <span class="n">only</span> <span class="k">if</span> <span class="n">DataReprocessing</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">;</span> <span class="n">only</span> <span class="n">sites</span> <span class="n">tagged</span> <span class="k">with</span> <span class="n">tag</span> <span class="n">will</span> <span class="n">be</span> <span class="n">considered</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="kc">None</span><span class="p">)</span>
<span class="o">-</span>   <span class="o">--</span><span class="n">log_file</span><span class="o">=</span>              <span class="p">:</span> <span class="n">Override</span> <span class="n">log</span> <span class="n">file</span> <span class="n">path</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">log</span> <span class="ow">in</span> <span class="n">analysis</span> <span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="download-data-and-merge-it">
<span id="download-and-merge"></span><h2>Download data and merge it<a class="headerlink" href="#download-data-and-merge-it" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">protopipe-DOWNLOAD_AND_MERGE</span></code> allows to download data serially, but also in <code class="docutils literal notranslate"><span class="pre">rsync</span></code>-style
(this second option is used as a backup crosscheck automatically in fact, to overcome any
network malfunction) and merge it in a single HDF5 file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Currently the merging is done locally, so both single files and merged file will be stored
locally resulting in a two-fold amount of disk-space usage.
This is of course not ideal: data should be merged on the grid.</p>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">protopipe</span><span class="o">-</span><span class="n">DOWNLOAD_AND_MERGE</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">metadata</span> <span class="n">METADATA</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">disable_download</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">disable_sync</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">disable_merge</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">indir</span> <span class="n">INDIR</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span><span class="p">]</span> <span class="o">--</span><span class="n">data_type</span>
                                    <span class="p">{</span><span class="n">TRAINING</span><span class="o">/</span><span class="n">for_energy_estimation</span><span class="p">,</span><span class="n">TRAINING</span><span class="o">/</span><span class="n">for_particle_classification</span><span class="p">,</span><span class="n">DL2</span><span class="p">}</span> <span class="o">--</span><span class="n">particle_types</span> <span class="p">[{</span><span class="n">gamma</span><span class="p">,</span><span class="n">proton</span><span class="p">,</span><span class="n">electron</span><span class="p">}</span> <span class="p">[{</span><span class="n">gamma</span><span class="p">,</span><span class="n">proton</span><span class="p">,</span><span class="n">electron</span><span class="p">}</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">n_jobs</span> <span class="n">N_JOBS</span><span class="p">]</span>
                                    <span class="p">[</span><span class="o">--</span><span class="n">cleaning_mode</span> <span class="n">CLEANING_MODE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">GRID</span><span class="o">-</span><span class="n">home</span> <span class="n">GRID_HOME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">GRID</span><span class="o">-</span><span class="n">path</span><span class="o">-</span><span class="n">from</span><span class="o">-</span><span class="n">home</span> <span class="n">GRID_PATH_FROM_HOME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">analysis_name</span> <span class="n">ANALYSIS_NAME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">local_path</span> <span class="n">LOCAL_PATH</span><span class="p">]</span>
                                    <span class="p">[</span><span class="o">--</span><span class="n">log_file</span> <span class="n">LOG_FILE</span><span class="p">]</span>

<span class="n">Download</span> <span class="ow">and</span> <span class="n">merge</span> <span class="n">data</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">DIRAC</span> <span class="n">grid</span><span class="o">.</span>

    <span class="n">The</span> <span class="n">default</span> <span class="n">behaviour</span> <span class="n">calls</span> <span class="n">an</span> <span class="n">rsync</span><span class="o">-</span><span class="n">like</span> <span class="n">command</span> <span class="n">after</span> <span class="n">the</span> <span class="n">normal</span> <span class="n">download</span> <span class="k">as</span>
    <span class="n">an</span> <span class="n">additional</span> <span class="n">check</span><span class="o">.</span>

    <span class="n">This</span> <span class="n">script</span> <span class="n">can</span> <span class="n">be</span> <span class="n">used</span> <span class="n">separately</span><span class="p">,</span> <span class="ow">or</span> <span class="ow">in</span> <span class="n">association</span> <span class="k">with</span> <span class="n">an</span> <span class="n">analysis</span> <span class="n">workflow</span><span class="o">.</span>
    <span class="n">In</span> <span class="n">the</span> <span class="n">second</span> <span class="n">case</span> <span class="n">the</span> <span class="n">recommended</span> <span class="n">usage</span> <span class="ow">is</span> <span class="n">via</span> <span class="n">the</span> <span class="n">metadata</span> <span class="n">file</span> <span class="n">produced</span> <span class="n">at</span> <span class="n">creation</span><span class="o">.</span>


<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
<span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
<span class="o">--</span><span class="n">metadata</span> <span class="n">METADATA</span>   <span class="n">Path</span> <span class="n">to</span> <span class="n">the</span> <span class="n">metadata</span> <span class="n">file</span> <span class="n">produced</span> <span class="n">at</span> <span class="n">analysis</span> <span class="n">creation</span>
                                <span class="p">(</span><span class="n">recommended</span> <span class="o">-</span> <span class="k">if</span> <span class="kc">None</span><span class="p">,</span> <span class="n">specify</span> <span class="n">necessary</span> <span class="n">information</span><span class="p">)</span><span class="o">.</span>
<span class="o">--</span><span class="n">disable_download</span>    <span class="n">Do</span> <span class="ow">not</span> <span class="n">download</span> <span class="n">files</span> <span class="n">serially</span>
<span class="o">--</span><span class="n">disable_sync</span>        <span class="n">Do</span> <span class="ow">not</span> <span class="n">syncronyze</span> <span class="n">folders</span> <span class="n">after</span> <span class="n">serial</span> <span class="n">download</span>
<span class="o">--</span><span class="n">disable_merge</span>       <span class="n">Do</span> <span class="ow">not</span> <span class="n">merge</span> <span class="n">files</span> <span class="n">at</span> <span class="n">the</span> <span class="n">end</span>
<span class="o">--</span><span class="n">indir</span> <span class="n">INDIR</span>         <span class="n">Override</span> <span class="nb">input</span> <span class="n">directory</span>
<span class="o">--</span><span class="n">outdir</span> <span class="n">OUTDIR</span>       <span class="n">Override</span> <span class="n">output</span> <span class="n">directory</span>
<span class="o">--</span><span class="n">data_type</span> <span class="p">{</span><span class="n">TRAINING</span><span class="o">/</span><span class="n">for_energy_estimation</span><span class="p">,</span><span class="n">TRAINING</span><span class="o">/</span><span class="n">for_particle_classification</span><span class="p">,</span><span class="n">DL2</span><span class="p">}</span>
                        <span class="n">Type</span> <span class="n">of</span> <span class="n">data</span> <span class="n">to</span> <span class="n">download</span> <span class="ow">and</span> <span class="n">merge</span>
<span class="o">--</span><span class="n">particle_types</span> <span class="p">[{</span><span class="n">gamma</span><span class="p">,</span><span class="n">proton</span><span class="p">,</span><span class="n">electron</span><span class="p">}</span> <span class="p">[{</span><span class="n">gamma</span><span class="p">,</span><span class="n">proton</span><span class="p">,</span><span class="n">electron</span><span class="p">}</span> <span class="o">...</span><span class="p">]]</span>
                        <span class="n">One</span> <span class="n">of</span> <span class="n">more</span> <span class="n">particle</span> <span class="nb">type</span> <span class="n">to</span> <span class="n">download</span> <span class="ow">and</span> <span class="n">merge</span>
<span class="o">--</span><span class="n">n_jobs</span> <span class="n">N_JOBS</span>       <span class="n">Number</span> <span class="n">of</span> <span class="n">parallel</span> <span class="n">jobs</span> <span class="k">for</span> <span class="n">directory</span> <span class="n">syncing</span> <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="mi">4</span><span class="p">)</span>
<span class="o">--</span><span class="n">cleaning_mode</span> <span class="n">CLEANING_MODE</span>
                        <span class="n">Deprecated</span> <span class="n">argument</span>
<span class="o">--</span><span class="n">GRID</span><span class="o">-</span><span class="n">home</span> <span class="n">GRID_HOME</span>
                        <span class="n">Path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">user</span><span class="s1">&#39;s home on DIRAC grid (/vo.cta.in2p3.fr/user/x/xxx)</span>
                                        <span class="p">(</span><span class="n">recommended</span><span class="p">:</span> <span class="n">use</span> <span class="n">metadata</span> <span class="n">file</span><span class="p">)</span>
<span class="o">--</span><span class="n">GRID</span><span class="o">-</span><span class="n">path</span><span class="o">-</span><span class="n">from</span><span class="o">-</span><span class="n">home</span> <span class="n">GRID_PATH_FROM_HOME</span>
                        <span class="n">optional</span> <span class="n">additional</span> <span class="n">path</span> <span class="kn">from</span> <span class="nn">user</span><span class="s1">&#39;s home in DIRAC (recommended: use metadata file)</span>
<span class="o">--</span><span class="n">analysis_name</span> <span class="n">ANALYSIS_NAME</span>
                        <span class="n">Name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">analysis</span> <span class="p">(</span><span class="n">recommended</span><span class="p">:</span> <span class="n">use</span> <span class="n">metadata</span> <span class="n">file</span><span class="p">)</span>
<span class="o">--</span><span class="n">local_path</span> <span class="n">LOCAL_PATH</span>
                        <span class="n">Path</span> <span class="n">where</span> <span class="n">shared_folder</span> <span class="ow">is</span> <span class="n">located</span> <span class="p">(</span><span class="n">recommended</span><span class="p">:</span> <span class="n">use</span> <span class="n">metadata</span> <span class="n">file</span><span class="p">)</span>
<span class="o">--</span><span class="n">log_file</span> <span class="n">LOG_FILE</span>   <span class="n">Override</span> <span class="n">log</span> <span class="n">file</span> <span class="n">path</span>
                                        <span class="p">(</span><span class="n">default</span><span class="p">:</span> <span class="n">analysis</span><span class="o">.</span><span class="n">log</span> <span class="ow">in</span> <span class="n">analysis</span> <span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="upload-models">
<span id="id1"></span><h2>Upload models<a class="headerlink" href="#upload-models" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">protopipe-UPLOAD_MODELS</span></code> allows you to upload both model files and their configuration files
to the DIRAC file catalog.
It allows to define a list of storage elements (SEs) where to store this data.
It will always try to upload to CC-IN3P3 first.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>usage: protopipe-UPLOAD_MODELS [-h] [--metadata METADATA] --cameras CAMERAS [CAMERAS ...] --model_type {regressor,classifier} --model_name {RandomForestRegressor,AdaBoostRegressor,RandomForestClassifier}
                            [--cleaning_mode CLEANING_MODE] [--GRID-home GRID_HOME] [--GRID-path-from-home GRID_PATH_FROM_HOME] [--list-of-SEs [LIST_OF_SES [LIST_OF_SES ...]]] [--analysis_name ANALYSIS_NAME]
                            [--local_path LOCAL_PATH] [--log_file LOG_FILE]

Upload models produced with protopipe to the Dirac grid.

    Files will be uploaded at least on CC-IN2P3-USER.
    You can use `cta-prod-show-dataset YOUR_DATASET_NAME --SEUsage` to know
    on which Dirac Storage Elements to replicate you models.
    Note: you will see *-Disk entries, but you need to replicate using *-USER entries.
    The default behaviour is replicate them to &quot;DESY-ZN-USER&quot;, &quot;CNAF-USER&quot;, &quot;CEA-USER&quot;.
    Replication is optional.


optional arguments:
-h, --help            show this help message and exit
--metadata METADATA   Path to the metadata file produced at analysis creation
                                (recommended - if None, specify necessary information).
--cameras CAMERAS [CAMERAS ...]
                        List of cameras to consider
--model_type {regressor,classifier}
                        Type of model to upload
--model_name {RandomForestRegressor,AdaBoostRegressor,RandomForestClassifier}
                        Type of model to upload
--cleaning_mode CLEANING_MODE
                        Deprecated argument
--GRID-home GRID_HOME
                        Path of the user&#39;s home on grid: /vo.cta.in2p3.fr/user/x/xxx (recommended: use metadata file).
--GRID-path-from-home GRID_PATH_FROM_HOME
                        Analysis path on DIRAC grid (defaults to user&#39;s home; recommended: use metadata file)
--list-of-SEs [LIST_OF_SES [LIST_OF_SES ...]]
                        List of DIRAC Storage Elements which will host the uploaded models
--analysis_name ANALYSIS_NAME
                        Name of the analysis (recommended: use metadata file)
--local_path LOCAL_PATH
                        Path where shared_folder is located (recommended: use metadata file)
--log_file LOG_FILE   Override log file path
                                        (default: analysis.log in analysis folder)
</pre></div>
</div>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../api/protopipe.benchmarks.RegressorDiagnostic.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">RegressorDiagnostic</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../contribute/index.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Development</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2020, Michele Peresano.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>